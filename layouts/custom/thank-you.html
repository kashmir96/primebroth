<!DOCTYPE html>
<html lang="ja">
<head>
    {{- partial "head.html" . -}}
    <meta name="description" content="{{ .Site.Params.homepage_meta_tags.meta_og_description }}" />
    <meta property="og:title" content="{{ .Site.Params.homepage_meta_tags.meta_og_title }}" />
    <meta property="og:type" content="{{ .Site.Params.homepage_meta_tags.meta_og_type }}" />
    <meta property="og:url" content="{{ .Site.Params.homepage_meta_tags.meta_og_url }}" />
    <meta property="og:image" content="{{ .Site.Params.homepage_meta_tags.meta_og_image }}" />
    <meta property="og:description" content="{{ .Site.Params.homepage_meta_tags.meta_og_description }}" />
    <meta name="twitter:card" content="{{ .Site.Params.homepage_meta_tags.meta_twitter_card }}" />
    <meta name="twitter:site" content="{{ .Site.Params.homepage_meta_tags.meta_twitter_site }}" />
    <meta name="twitter:creator" content="{{ .Site.Params.homepage_meta_tags.meta_twitter_creator }}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
    <script src="https://platform-api.sharethis.com/js/sharethis.js#property=667c998f7bead90019480329&product=inline-share-buttons&source=platform" async="async"></script>
    <script>
        window.addEventListener('load', (event) => {
          fathom.trackEvent('checkout completed');
        });
    </script>
    <!-- Event snippet for Purchase (1) conversion page -->
<script>
    gtag('event', 'conversion', {
        'send_to': 'AW-16543078874/NBm3CM_yx9MZENqzrdA9',
        'transaction_id': ''
    });
  </script>
  
</head>
<body>
    {{- partial "header.html" . -}}
    <div class="scroll-top rounded-full">
        <span class="icon-keyboard_arrow_up text-2xl"></span>
    </div>
    {{- partial "slide.html" . -}}
    {{- partial "strip.html" . -}}
    <!-- Add html below -->

    <div class="container">
        <div class="row peach max-width text-center">
            <h1 class="fade-in-element">Thank you for your order!</h1>
        </div>
        <div class="row justify-content-around">
            <div class="col">
                <p>Thanks for your order of Primebroth!</p>
                <p>Unless otherwise stated, we will process your order within 1-3 business days and have it shipped out the following day. Keep an eye on your inbox, we'll let you know when your goods are on the way! </p>
                <p>If you have any questions or queries about your order, get in touch with hello@primebroth.co.nz and we will help you out! </p>
                <!--  <div id="shareThisContainer"></div>-->

            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const pgurl = localStorage.getItem('pgurl');
            const charity = localStorage.getItem('charity');
            console.log('pgurl retrieved:', pgurl);  // Debugging line
            console.log('charity retrieved:', charity);  // Debugging line
            const shareThisContainer = document.getElementById('shareThisContainer');
            if (pgurl && charity) {
                // Display charity information
                const charityInfo = document.createElement('h5');
                charityInfo.className = 'charity-message';
                charityInfo.textContent = `Help us support ${charity} further by sharing the fundraiser with your friends!`;
                shareThisContainer.appendChild(charityInfo);
                console.log('Charity message added:', charityInfo.textContent);  // Debugging line
    
                const shareThisButton = document.createElement('div');
                shareThisButton.className = 'sharethis-inline-share-buttons';
                shareThisButton.setAttribute('data-url', `https://www.primebroth.co.nz/${pgurl}`);
                shareThisContainer.appendChild(shareThisButton);
                console.log('ShareThis button created with URL:', `https://www.primebroth.co.nz/${pgurl}`);  // Debugging line
    
                // Initialize ShareThis buttons
                window.__sharethis__.load('inline-share-buttons', {
                    alignment: 'center',
                    id: 'sharethis-inline-share-buttons',
                    url: `https://www.primebroth.co.nz/${pgurl}`
                });
            } else {
                // Fallback message and link
                const fallbackMessage = document.createElement('h5');
                fallbackMessage.className = 'fallback-message';
    
                // Create the first line
                const line1 = document.createElement('span');
                line1.textContent = 'Who else do you know who might enjoy Primebroth?';
                fallbackMessage.appendChild(line1);
    
                // Create a line break
                fallbackMessage.appendChild(document.createElement('br'));
    
                // Create the second line
                const line2 = document.createElement('span');
                line2.textContent = 'Gift a free sample to a friend.';
                fallbackMessage.appendChild(line2);
    
                shareThisContainer.appendChild(fallbackMessage);
                console.log('Fallback message added:', fallbackMessage.textContent);  // Debugging line
    
                const shareThisButton = document.createElement('div');
                shareThisButton.className = 'sharethis-inline-share-buttons st-btn';
                shareThisButton.setAttribute('data-url', `https://www.primebroth.co.nz/products/free-pets-powder`);
                shareThisContainer.appendChild(shareThisButton);
                console.log('ShareThis button created with fallback URL:', `https://www.primebroth.co.nz/products/free-pets-powder`);  // Debugging line
    
                // Initialize ShareThis buttons
                window.__sharethis__.load('inline-share-buttons', {
                    alignment: 'center',
                    id: 'sharethis-inline-share-buttons',
                    url: `https://www.primebroth.co.nz/products/free-pets-powder`
                });
            }
    
                // Add click event listener to ShareThis buttons
                window.addEventListener('load', () => {
                document.querySelectorAll('.st-btn').forEach(element => {
                    element.addEventListener('click', () => {
                        gtag('event', 'sharethis_click', {
                            'event_category': 'share',
                            'event_label': 'sharethis',
                            'value': 1
                        });
                    });
                });
            });
        });
    </script>
   
   <script>
    window.addEventListener('load', function() {
        // Retrieve total cost from localStorage
        let totalCost = localStorage.getItem("totalCost");

        // Convert totalCost to a number and validate
        totalCost = parseFloat(totalCost);
        if (isNaN(totalCost) || totalCost <= 0) {
            console.error("Invalid total cost:", totalCost);
            totalCost = 0; // Set a fallback or handle error as needed
        } else {
            console.log("Total cost retrieved:", totalCost);
        }

        const currency = "NZD"; // Set your currency
        const userEmail = "hashed_email_here"; // Replace with actual hashed email if available

        // Send data to the Netlify function for the Facebook Conversions API
        fetch("/.netlify/functions/track-event", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                action: "Purchase", // Event name
                cartTotal: totalCost, // Send totalCost as cartTotal
                currency: currency,
                userData: {
                    em: userEmail // Replace with hashed email if available
                }
            })
        })
        .then(response => response.json())
        .then(data => console.log("Conversion event sent:", data))
        .catch(error => console.error("Error sending conversion event:", error));
    });
</script>



  
      
    
    
    



    <!-- Add html above -->
    {{- partial "footer.html" . -}}
</body>
</html>
